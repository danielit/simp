Ext.Loader.setPath('Ext.ux', './static/extjs/examples/ux');

Ext.require(['Ext.grid.Panel', 'Ext.grid.*', 'Ext.window.Window', 'Ext.container.Viewport', 'Ext.container.Container', 'Ext.layout.container.Border', 'Ext.state.*', 'Ext.data.*', 'Ext.tab.*', 'Ext.util.*', 'Ext.toolbar.Paging', 'Ext.String.*', 'Ext.selection.Model', ]);


Ext.define('news.Form', {
	extend: 'Ext.form.Panel',
	alias: 'widget.newsform',
	requires: ['Ext.data.*', 'Ext.form.*'],
	//xtype: 'form-news',
	frame: true,
	bodyPadding: 5,
    //maxHeight:200,
    autoScroll:true,

	initComponent: function() {
		Ext.apply(this, {
		    iconCls: 'icon-form',
            collapsible:'ture',
			//align: 'center',
			items: []
		});
		this.callParent();
	}
});

Ext.define('news.TreePanel', {
	extend: 'Ext.tree.Panel',
	alias: 'widget.newstreepanel',
//var newsTreePanel = Ext.create('Ext.tree.Panel', {
    id: 'newstreepanel',
    title: '通知/公告',
    split: true,
    //region:'west',
    width: 200,
    maxWidth:400,
    //height:'100%',
    //animCollapse: true,
    rootVisible: false,  //默认不显示根节点
    useArrows: true,
    store: news_list_store,
    root: {expanded: true},
    tools: [{
        type: 'refresh',
        tooltip: '刷新',
        handler: function() {//Ext.data.Store load
            news_list_store.load({
                scope: this,
                callback: function(records, operation, success) {
                    //Ext.Msg.alert('refresh success!');
                    //newsTreePanel.getRootNode().eachChild(function(child) { child.expand(); });
                }
            });
        }
    }
    ],
    collapsible: false,
    listeners: {
        'load' : function(){
            newsTreePanel.expandAll();
        }, 

        'itemclick': function(view, record, item, index, e) {
            nodeId = record.raw.id; //获取点击的节点id
            nodeText = record.raw.text; //获取点击的节点text
            //Ext.Msg.alert('info', nodeId + nodeText);
            if (news_list_store.getNodeById(nodeId).hasChildNodes() === true) {
                //ReloadMainCollectionGridTab(nodeId, 'QB', Ext.getCmp('datepicker').getRawValue(), 1, 0, 0, 1, 0, 0, 0, 0, nodeText); //
            }
            else {
                //LoadConcentratorInfoStore(nodeId);
                Ext.Msg.alert('设备管理', nodeId + nodeText);
            }
            //Ext.Msg.alert('text', nodeText);

        }
    }
});

Ext.require(['Ext.data.*', 'Ext.tip.QuickTipManager', 'Ext.window.MessageBox']);

//define the container for news 
Ext.define('news.window', {
	extend: 'Ext.container.Container',
	alias: 'widget.newswin',
	
    initComponent: function() {
		Ext.apply(this, {
			padding: '0 0 0 0',
			/*layout: {
				type: 'border',
                padding:'5'
			},*/
            layout:'border',
			items: [{
                region:'west',
                xtype:'newstreepanel',
                id:'newstreepanel',
                width:'200'
            },
            //newsTreePanel,
            {
                region:'center',
                xtype:'newsform',
                id:'newsform',
                width:'500'
                //height:'100%'
            }]
		});
		this.callParent();
	}
});
function getnewsWin(){
    var newsWin = Ext.getCmp('newswin') ;
    if (newsWin==null){
        newsWin = Ext.create('news.window',{
            title:'通知/公告',
            id:'newswin',
            itemId:'newswin',
            //xtype:'newscontainer',
		    icon: 'static/pic/css/tabs.gif'
        }) ; 
    } 
    //newsform = Ext.getCmp('newsform') ;
    //newsform.html = "helloworld helloworld </br>hello world </br>" ;
    return newsWin ;
}
